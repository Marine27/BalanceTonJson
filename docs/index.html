<!DOCTYPE html>
<html lang="fr">

<head>

    <link rel="stylesheet" href="css/style.css">
    <meta charset="UTF-8">

    <title> BalanceTonJson </title>

    <!-- Library dependancy -->
    <!--    -->
</head>

<body>
    <div class="grid-container">
        <div class="terminal">
            <div class="headterminal"></div>
            <div class="areaterminal"></div>
        </div>
        <div class="files">
            <div class="headfiles"></div>
            <div class="choosefiles"></div>
            <div class="areafiles"></div>
        </div>
        <div class="desktop">
            <a><img class="icon" src="media/firefox.png" title="Use Firefox please"></a><br>
            <a><img class="icon" src="media/appstore.png" title="Go snap, Go ubuntu"></a><br>
            <a><img class="icon" src="media/thunderbird.png" title="send us a mail"></a><br>
            <a><img class="icon" src="media/git.png" title="Our git repository is public, check it"></a><br>
            <a><img class="icon" src="media/folder.png" title="API Documentation"></a><br>
            <a><img class="icon" src="media/json.png" title="JSON structure"></a><br>
            <a><img class="icon" src="media/rdf.png" title=" RDF structure "></a><br>
            <a><img class="icon" src="media/natoine.png" title="Minimum 15 <3 "></a><br>
            <a><img class="icon" src="media/terminal.png" title="Easter Egg"></a><br>
            <a><img id="appselector" class="icon" src="media/appselector.png" title="Back to normal"></a><br>







        </div>
        <div class="TOP"> Activité <span class="horloge" id="timeDisplay"></span> MIASHS-M2



        </div>
        <div class="blankarea">
            <label for="radius">Rayon de recherche</label>
            <input type="range" class="custom-range" id="radius" min="0" max="50" value="0" />
            <small id="radius-val" class="form-text text-muted">Emprise de la zone sélectionnée</small>

        </div>

        <script type="text/javascript" src="js/utils.js"></script>
        <script>
            function updateAPI(radius) {
                var myHeaders = new Headers();
                myHeaders.append("Content-Type", "application/json");
                fetch('http://localhost:3000/velib', {
                    method: 'post',
                    headers: myHeaders,
                    body: JSON.stringify({
                        "radius": radius
                    })
                }).then(function(response) {
                    return response.json();
                }).then(function(data) {
                    console.log('data from api:', data);
                });
            }
            // Radius selector with special value 0
            const lblRadius = document.getElementById("radius-val");
            const iptRadius = document.getElementById("radius");
            iptRadius.value = "0";
            iptRadius.addEventListener("input", () => {
                const newVal = parseInt(document.getElementById("radius").value);
                console.log("newval", newVal);
                lblRadius.innerHTML = newVal === 0 ? "Emprise de la zone sélectionnée" : newVal + "km autour du centre géométrique";
                updateAPI(newVal)
            });
        </script>

    </div>
</body>

</html>